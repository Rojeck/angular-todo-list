"use strict";(self.webpackChunkTODOListProject=self.webpackChunkTODOListProject||[]).push([[907],{6907:(Dt,S,d)=>{d.r(S),d.d(S,{DashboardPageModule:()=>gt});var p=d(6895),D=d(3841),i=d(433),s=d(2997);const C=(0,s.PH)("[DASHBOARDS] Get dashboards"),x=(0,s.PH)("[DASHBOARDS] Get dashboards success",(0,s.Ky)()),E=(0,s.PH)("[DASHBOARDS] Get dashboards failure"),Z=(0,s.PH)("[DASHBOARDS] Open dashboard create modal"),F=(0,s.PH)("[DASHBOARDS] Open dashboard edit modal"),H=(0,s.PH)("[DASHBOARDS] Close dashboard create modal"),k=(0,s.PH)("[DASHBOARDS] Close dashboard create modal"),P=(0,s.PH)("[DASHBOARDS] Create dashboard action",(0,s.Ky)()),y=(0,s.PH)("[DASHBOARDS] Edit dashboard action",(0,s.Ky)()),g=(0,s.PH)("[DASHBOARDS] Create/edit dashboard success action"),v=(0,s.PH)("[DASHBOARDS] Create/edit dashboard failure action"),A=(0,s.PH)("[DASHBOARDS] Delete dashboard action",(0,s.Ky)()),O=(0,s.PH)("[DASHBOARDS] Delete dashboard success action"),B=(0,s.PH)("[DASHBOARDS] Delete dashboard failure action"),T=(0,s.PH)("[DASHBOARDS] sort by value change",(0,s.Ky)()),M=(0,s.PH)("[DASHBOARDS] sort type value change",(0,s.Ky)()),L=(0,s.PH)("[DASHBOARDS] sort dashboards action",(0,s.Ky)()),h=(0,s.ZF)("dashboards"),V=((0,s.P1)(h,e=>e.isLoading),(0,s.P1)(h,e=>e.dashboards)),w=(0,s.P1)(h,e=>e.backEndErrors),J=(0,s.P1)(h,e=>e.isDashboardCreateModalOpen),I=(0,s.P1)(h,e=>e.isDashboardEditModalOpen),z=(0,s.P1)(h,e=>e.changeDashboardFailure),N=(0,s.P1)(h,e=>e.sortTypeValue),U=(0,s.P1)(h,e=>e.sortByValue);var t=d(4650),G=d(312),R=d(3963),Y=d(6772);let j=(()=>{class e{constructor(){this.editEmmiter=new t.vpe,this.deleteEmmiter=new t.vpe}ngOnInit(){this.initValues()}initValues(){this.title=this.subject.name,this.description=this.subject.description,this.createdDate=this.subject.created_at,this.taskCounterTodo=this.countTasks("TODO"),this.taskCounterInProgress=this.countTasks("IN_PROGRESS"),this.taskCounterDone=this.countTasks("DONE")}countTasks(o){return this.subject.tasks.filter(a=>a.status===o).length||0}editDashboard(){this.editEmmiter.emit(this.subject)}deleteDashboard(){this.deleteEmmiter.emit(this.subject)}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dashboard"]],inputs:{subject:"subject"},outputs:{editEmmiter:"editEmmiter",deleteEmmiter:"deleteEmmiter"},decls:23,vars:8,consts:[[1,"content"],[1,"menu",3,"click"],["menu",""],[1,"menu-item",3,"click"],[1,"title"],[1,"description"],[1,"created-date"],[1,"counter"],[1,"counter-item"]],template:function(o,r){if(1&o){const a=t.EpF();t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(ft){t.CHM(a);const _t=t.MAs(4);return t.KtG(_t.toggle(ft))}),t._uU(2,"..."),t.qZA(),t.TgZ(3,"app-element-menu",null,2)(5,"div",3),t.NdJ("click",function(){return r.editDashboard()}),t._uU(6,"Edit"),t.qZA(),t.TgZ(7,"div",3),t.NdJ("click",function(){return r.deleteDashboard()}),t._uU(8,"Delete"),t.qZA()(),t.TgZ(9,"div",4),t._uU(10),t.qZA(),t.TgZ(11,"div",5),t._uU(12),t.qZA(),t.TgZ(13,"div",6),t._uU(14),t.ALo(15,"date"),t.qZA(),t.TgZ(16,"div",7)(17,"div",8),t._uU(18),t.qZA(),t.TgZ(19,"div",8),t._uU(20),t.qZA(),t.TgZ(21,"div",8),t._uU(22),t.qZA()()()}2&o&&(t.xp6(10),t.Oqu(r.title),t.xp6(2),t.Oqu(r.description),t.xp6(2),t.Oqu(t.lcZ(15,6,r.createdDate)),t.xp6(4),t.hij("\u271a: ",r.taskCounterTodo," "),t.xp6(2),t.hij("\u267a: ",r.taskCounterInProgress," "),t.xp6(2),t.hij("\u2611: ",r.taskCounterDone," "))},dependencies:[Y.T,p.uU],styles:["[_nghost-%COMP%]{width:300px;height:200px;border-radius:5px;background-color:#fff;border:2px solid green;color:#504f4f;position:relative;z-index:2;font-family:Arial,Helvetica,sans-serif;transition:all .2s ease-in-out;display:inline-block;margin:10px;cursor:pointer}[_nghost-%COMP%]   .title[_ngcontent-%COMP%]{color:green}[_nghost-%COMP%]:hover{background-color:green;color:#fff}[_nghost-%COMP%]:hover   .counter[_ngcontent-%COMP%]{font-size:16px;height:16px}[_nghost-%COMP%]:hover   .title[_ngcontent-%COMP%]{color:#fff}.content[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;gap:5px;flex-direction:column;box-sizing:border-box;padding:10px}.content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:22px}.content[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{flex:1 1 auto;font-size:16px}.content[_ngcontent-%COMP%]   .created-date[_ngcontent-%COMP%]{text-align:end;font-size:18px}.menu[_ngcontent-%COMP%]{position:absolute;top:-5px;right:10px;font-size:25px}.menu-item[_ngcontent-%COMP%]{font-size:16px;padding:5px;color:green;transition:all .2s;line-height:14px}.menu-item[_ngcontent-%COMP%]:hover{background-color:#00800057;color:#fff}p[_ngcontent-%COMP%]{margin:0}.counter[_ngcontent-%COMP%]{display:flex;gap:15px;height:0px;font-size:0px;transition:.5s;position:relative;top:0;left:0;z-index:0}"],changeDetection:0}),e})(),K=(()=>{class e{transform(o,r){return o.filter(a=>!(!a.name.toLowerCase().includes(r.toLowerCase())&&!a.tasks.filter(l=>l.name.toLowerCase().includes(r.toLowerCase())).length))}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275pipe=t.Yjl({name:"filterDashboards",type:e,pure:!0}),e})();function Q(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"div",9),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.openDashboardCreateWindow())}),t.TgZ(1,"p",10),t._uU(2,"Add dashboard"),t.qZA()()}}function W(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"app-dashboard",11),t.NdJ("editEmmiter",function(a){t.CHM(o);const l=t.oxw(2);return t.KtG(l.openDashboardEditWindow(a))})("deleteEmmiter",function(a){t.CHM(o);const l=t.oxw(2);return t.KtG(l.deleteDashboard(a))}),t.qZA()}if(2&e){const o=n.$implicit;t.Q6J("subject",o)("routerLink","dashboard/"+o._id)}}function q(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Q,3,0,"div",7),t._UZ(2,"br"),t.YNc(3,W,1,2,"app-dashboard",8),t.ALo(4,"filterDashboards"),t.qZA()),2&e){const o=n.ngIf,r=t.oxw();t.xp6(1),t.Q6J("ngIf",0!==o.length),t.xp6(2),t.Q6J("ngForOf",t.xi3(4,2,o,r.filterValue))}}function X(e,n){1&e&&(t.TgZ(0,"div",12),t._uU(1," Opps.... Something went wrong! "),t.TgZ(2,"a",13),t._uU(3,"Try again!"),t.qZA()())}function tt(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"div",12),t._uU(1," Dashboard page is empty. "),t.TgZ(2,"span",14),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.openDashboardCreateWindow())}),t._uU(3,"Add your first dashboard!"),t.qZA()()}}function et(e,n){1&e&&(t.TgZ(0,"p",20),t._uU(1," An error occured. Please, try later "),t.qZA())}function ot(e,n){1&e&&(t.TgZ(0,"p",20),t._uU(1," Name should be at least 6 symbols and not more than 24 symbols, description should be not more than 52 symbols "),t.qZA())}function at(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"app-modal",15),t.NdJ("modalClose",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.closeDashboardCreateModal())})("modalSubmit",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.postDashboard())}),t.YNc(1,et,2,0,"p",16),t.ALo(2,"async"),t.YNc(3,ot,2,0,"p",16),t.TgZ(4,"form",17),t._UZ(5,"input",18)(6,"textarea",19),t.qZA()()}if(2&e){const o=t.oxw();t.Q6J("title","Create dashboard"),t.xp6(1),t.Q6J("ngIf",t.lcZ(2,4,o.changeDashboardsError$)),t.xp6(2),t.Q6J("ngIf",o.isValidationError),t.xp6(1),t.Q6J("formGroup",o.dashboardForm)}}function st(e,n){1&e&&(t.TgZ(0,"p",20),t._uU(1," An error occured. Please, try later "),t.qZA())}function rt(e,n){1&e&&(t.TgZ(0,"p",20),t._uU(1," Name should be at least 6 symbols and not more than 24 symbols, description should be not more than 52 symbols "),t.qZA())}function nt(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"app-modal",15),t.NdJ("modalClose",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.closeDashboardEditModal())})("modalSubmit",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.editDashboard())}),t.YNc(1,st,2,0,"p",16),t.ALo(2,"async"),t.YNc(3,rt,2,0,"p",16),t.TgZ(4,"form",17),t._UZ(5,"input",18)(6,"textarea",19),t.qZA()()}if(2&e){const o=t.oxw();t.Q6J("title","Edit dashboard"),t.xp6(1),t.Q6J("ngIf",t.lcZ(2,4,o.changeDashboardsError$)),t.xp6(2),t.Q6J("ngIf",o.isValidationError),t.xp6(1),t.Q6J("formGroup",o.dashboardForm)}}const dt=[{path:"",component:(()=>{class e{constructor(o){this.store=o,this.isValidationError=!1,this.filterValue=""}ngOnInit(){this.store.dispatch(C()),this.initValues()}setFilterValue(o){this.filterValue=o}sortTypeChange(o){this.store.dispatch(M({value:o}))}sortByChange(o){this.store.dispatch(T({value:o}))}createForm(o=null,r=null,a=!1){this.dashboardForm=new i.cw({name:new i.NI(o,[i.kI.minLength(6),i.kI.maxLength(24),i.kI.required]),description:new i.NI({value:r,disabled:a},i.kI.maxLength(52))})}initValues(){this.dashboards$=this.store.pipe((0,s.Ys)(V)),this.getDashboardsError$=this.store.pipe((0,s.Ys)(w)),this.changeDashboardsError$=this.store.pipe((0,s.Ys)(z)),this.isCreateModalVisible$=this.store.pipe((0,s.Ys)(J)),this.isEditModalVisible$=this.store.pipe((0,s.Ys)(I)),this.sortTypeValue$=this.store.pipe((0,s.Ys)(N)),this.sortByValue$=this.store.pipe((0,s.Ys)(U))}checkError(){return this.dashboardForm.get("name")?.errors||this.dashboardForm.get("description")?.errors?(this.isValidationError=!0,!1):(this.isValidationError=!1,!0)}openDashboardCreateWindow(){this.createForm(),this.store.dispatch(Z())}closeDashboardCreateModal(){this.store.dispatch(H())}postDashboard(){this.checkError()&&(this.store.dispatch(P({dashboard:this.dashboardForm.value})),this.dashboardForm.reset())}openDashboardEditWindow(o){this.subject=o,this.createForm(o.name,o.description,!0),this.store.dispatch(F())}closeDashboardEditModal(){this.store.dispatch(k())}editDashboard(){this.checkError()&&(this.store.dispatch(y({dashboard:this.dashboardForm.value,dashboardId:this.subject._id})),this.dashboardForm.reset())}deleteDashboard(o){this.store.dispatch(A({dashboardId:o._id}))}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(s.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dashboard-page"]],decls:20,vars:21,consts:[[3,"sortByValue","sortTypeValue","sortTypeChanged","sortByChanged","filterChanged"],["value","name"],["value","date"],["value","countOfTasks"],[4,"ngIf"],["class","dashboard-statate-message",4,"ngIf"],[3,"title","modalClose","modalSubmit",4,"ngIf"],["class","add-dashboard-button",3,"click",4,"ngIf"],[3,"subject","routerLink","editEmmiter","deleteEmmiter",4,"ngFor","ngForOf"],[1,"add-dashboard-button",3,"click"],[1,"add-dashboard-button__text"],[3,"subject","routerLink","editEmmiter","deleteEmmiter"],[1,"dashboard-statate-message"],["href","/"],[1,"dashboard-statate-message__add-dashboard",3,"click"],[3,"title","modalClose","modalSubmit"],["class","modal-error-message",4,"ngIf"],[1,"modal-form",3,"formGroup"],["formControlName","name","type","text","placeholder","dashboard name",1,"form__input"],["formControlName","description","type","text","placeholder","dashboard description","rows","10",1,"form__input"],[1,"modal-error-message"]],template:function(o,r){if(1&o&&(t.TgZ(0,"app-sort",0),t.NdJ("sortTypeChanged",function(l){return r.sortTypeChange(l)})("sortByChanged",function(l){return r.sortByChange(l)})("filterChanged",function(l){return r.setFilterValue(l)}),t.ALo(1,"async"),t.ALo(2,"async"),t.TgZ(3,"option",1),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"option",2),t._uU(6,"Date"),t.qZA(),t.TgZ(7,"option",3),t._uU(8,"Count"),t.qZA()(),t.YNc(9,q,5,5,"div",4),t.ALo(10,"async"),t.YNc(11,X,4,0,"div",5),t.ALo(12,"async"),t._UZ(13,"div"),t.YNc(14,tt,4,0,"div",5),t.ALo(15,"async"),t.YNc(16,at,7,6,"app-modal",6),t.ALo(17,"async"),t.YNc(18,nt,7,6,"app-modal",6),t.ALo(19,"async")),2&o){let a;t.Q6J("sortByValue",t.lcZ(1,7,r.sortByValue$))("sortTypeValue",t.lcZ(2,9,r.sortTypeValue$)),t.xp6(9),t.Q6J("ngIf",t.lcZ(10,11,r.dashboards$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(12,13,r.getDashboardsError$)),t.xp6(3),t.Q6J("ngIf",0===(null==(a=t.lcZ(15,15,r.dashboards$))?null:a.length)),t.xp6(2),t.Q6J("ngIf",t.lcZ(17,17,r.isCreateModalVisible$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(19,19,r.isEditModalVisible$))}},dependencies:[p.sg,p.O5,D.rH,G.z,i._Y,i.YN,i.Kr,i.Fj,i.JJ,i.JL,i.sg,i.u,R.x,j,p.Ov,K],styles:["[_nghost-%COMP%]{position:relative;z-index:5}.dashboard-statate-message[_ngcontent-%COMP%]{padding-top:100px;height:100%;text-align:center;font-size:25px;color:#5e5e5e}.dashboard-statate-message__add-dashboard[_ngcontent-%COMP%]{text-decoration:underline;cursor:pointer;transition:all .3s}.dashboard-statate-message__add-dashboard[_ngcontent-%COMP%]:hover{text-decoration:none;color:green}.add-dashboard-button[_ngcontent-%COMP%]{width:300px;height:200px;border-radius:5px;border:2px solid green;color:#504f4f;font-family:Arial,Helvetica,sans-serif;transition:all .2s ease-in-out;display:inline-flex;flex-direction:column;align-items:center;justify-content:center;margin:10px;cursor:pointer}.add-dashboard-button[_ngcontent-%COMP%]:hover{background-color:green;color:#fff}.add-dashboard-button[_ngcontent-%COMP%]:hover   .text[_ngcontent-%COMP%]{color:#fff}.add-dashboard-button__text[_ngcontent-%COMP%]{font-size:22px}.modal-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:10px;gap:20px}.modal-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;border:5px;height:35px;font-size:18px;border:1px solid gray;box-sizing:border-box;color:#444;padding:5px;font-family:serif}.modal-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{font-size:18px;border:1px solid gray;box-sizing:border-box;color:#444;padding:5px;font-family:serif}.modal-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{border:1px solid rgba(0,0,255,.233)}.modal-error-message[_ngcontent-%COMP%]{font-size:14px;color:red;text-align:center}"],changeDetection:0}),e})()}];let it=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[D.Bz.forChild(dt),D.Bz]}),e})();var lt=d(5811),ct=d(8332),ht=d(6933),c=d(2655),u=d(3900),b=d(9646),m=d(4004),f=d(262),_=d(2340),pt=d(529);let $=(()=>{class e{constructor(o,r){this.http=o,this.store=r,this.store.select(V).subscribe(a=>{this.dashboards=a}),this.store.select(N).subscribe(a=>{this.sortTypeValue=a}),this.store.select(U).subscribe(a=>{this.sortByValue=a})}getDashboards(){return this.http.get(_.N.apiUrl+"dashboards").pipe((0,m.U)(r=>r.map(a=>({name:a.name,description:a.description,created_at:a.created_at,created_by:a.created_by,_id:a._id,tasks:a.tasks,colors:a.colors}))))}postDashboard(o){return this.http.post(_.N.apiUrl+"dashboards",o)}editDashboard(o,r){return this.http.patch(`${_.N.apiUrl}dashboards/${r}`,o)}deleteDashboard(o){return this.http.delete(`${_.N.apiUrl}dashboards/${o}`)}sortDashboards(){if(this.dashboards){let o=[...this.dashboards];switch(this.sortByValue){case"name":o=this.sortByName(o);break;case"date":o=this.sortByDate(o);break;case"countOfTasks":o=this.sortByTasksCount(o)}return"DESC"===this.sortTypeValue&&(o=this.sortReverse(o)),o}return null}sortByName(o){return o.sort((r,a)=>r?.name>a?.name?1:-1)}sortByDate(o){return console.log(o.sort((r,a)=>Date.parse(a.created_at.toString())-Date.parse(r.created_at.toString()))),o.sort((r,a)=>Date.parse(a.created_at.toString())-Date.parse(r.created_at.toString()))}sortByTasksCount(o){return o.sort((r,a)=>a.tasks.length-r.tasks.length)}sortReverse(o){return o.reverse()}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(pt.eN),t.LFG(s.yh))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})(),ut=(()=>{class e{constructor(o,r){this.actions$=o,this.dashboardService=r,this.sortDashboards$=(0,c.GW)(()=>this.actions$.pipe((0,c.l4)(x,M,T),(0,u.w)(()=>(0,b.of)(L({dashboards:this.dashboardService.sortDashboards()}))))),this.getDashboardsEffect$=(0,c.GW)(()=>this.actions$.pipe((0,c.l4)(C,g,O),(0,u.w)(()=>this.dashboardService.getDashboards().pipe((0,m.U)(a=>x({dashboards:a})),(0,f.K)(()=>(0,b.of)(E())))))),this.postDashboardsEffect$=(0,c.GW)(()=>this.actions$.pipe((0,c.l4)(P),(0,u.w)(({dashboard:a})=>this.dashboardService.postDashboard(a).pipe((0,m.U)(()=>g()),(0,f.K)(()=>(0,b.of)(v())))))),this.editDashboardsEffect$=(0,c.GW)(()=>this.actions$.pipe((0,c.l4)(y),(0,u.w)(({dashboard:a,dashboardId:l})=>this.dashboardService.editDashboard(a,l).pipe((0,m.U)(()=>g()),(0,f.K)(()=>(0,b.of)(v())))))),this.deleteDashboardEffect$=(0,c.GW)(()=>this.actions$.pipe((0,c.l4)(A),(0,u.w)(({dashboardId:a})=>this.dashboardService.deleteDashboard(a).pipe((0,m.U)(()=>O()),(0,f.K)(()=>(0,b.of)(B()))))))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(c.eX),t.LFG($))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();const mt=(0,s.Lq)({backEndErrors:null,dashboards:null,isLoading:null,isDashboardCreateModalOpen:!1,isDashboardEditModalOpen:!1,changeDashboardFailure:!1,sortTypeValue:"ASC",sortByValue:"date"},(0,s.on)(C,e=>({...e,isLoading:!0})),(0,s.on)(x,(e,n)=>({...e,isLoading:!1,dashboards:n.dashboards})),(0,s.on)(E,e=>({...e,isLoading:!1,backEndErrors:!0,dashboards:null})),(0,s.on)(Z,e=>({...e,isDashboardCreateModalOpen:!0})),(0,s.on)(H,e=>({...e,isDashboardCreateModalOpen:!1})),(0,s.on)(P,e=>({...e,isLoading:!0,changeDashboardFailure:!1})),(0,s.on)(y,e=>({...e,isLoading:!0,changeDashboardFailure:!1})),(0,s.on)(g,e=>({...e,isDashboardCreateModalOpen:!1,isDashboardEditModalOpen:!1,isLoading:!1})),(0,s.on)(v,e=>({...e,isLoading:!1,changeDashboardFailure:!0})),(0,s.on)(F,e=>({...e,isDashboardEditModalOpen:!0})),(0,s.on)(k,e=>({...e,isDashboardEditModalOpen:!1})),(0,s.on)(A,e=>({...e})),(0,s.on)(O,e=>({...e})),(0,s.on)(B,e=>({...e})),(0,s.on)(T,(e,n)=>({...e,sortByValue:n.value})),(0,s.on)(M,(e,n)=>({...e,sortTypeValue:n.value})),(0,s.on)(L,(e,n)=>({...e,dashboards:n.dashboards})));let gt=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[$],imports:[p.ez,it,lt.z,i.UX,ct.U,ht.t,s.Aw.forFeature("dashboards",mt),c.sQ.forFeature([ut])]}),e})()}}]);