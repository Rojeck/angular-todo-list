"use strict";(self.webpackChunkTODOListProject=self.webpackChunkTODOListProject||[]).push([[160],{9160:(Ut,D,c)=>{c.r(D),c.d(D,{TaskPageModule:()=>Gt});var p=c(6895),A=c(529),v=c(3841),s=c(2997),_=c(4004);const w=(0,s.PH)("[TASKS] Open task create modal"),J=(0,s.PH)("[TASKS] Open task edit modal"),V=(0,s.PH)("[TASKS] Close task create modal"),L=(0,s.PH)("[TASKS] Close task create modal"),E=(0,s.PH)("[TASKS] Create task action",(0,s.Ky)()),X=(0,s.PH)("[TASKS] Create task action"),S=(0,s.PH)("[TASKS] Edit task action",(0,s.Ky)()),tt=(0,s.PH)("[TASKS] Edit task failure action"),b=(0,s.PH)("[TASKS] Change task status action",(0,s.Ky)()),H=(0,s.PH)("[TASKS] Change task status failure action"),y=(0,s.PH)("[TASKS] Delete task action",(0,s.Ky)()),et=(0,s.PH)("[TASKS] Delete task failure action"),h=(0,s.PH)("[TASKS] Create/edit task success action",(0,s.Ky)()),G=(0,s.PH)("[TASKS] Delete dashboard action",(0,s.Ky)()),nt=(0,s.PH)("[TASKS] Delete dashboard failure action"),U=(0,s.PH)("[TASKS] Delete dashboard success action"),C=(0,s.PH)("[TASKS] sort by value change",(0,s.Ky)()),P=(0,s.PH)("[TASKS] sort type value change",(0,s.Ky)()),Q=(0,s.PH)("[TASKS] sort tasks action",(0,s.Ky)()),x=(0,s.PH)("[TASKS] Get dashboard",(0,s.Ky)()),M=(0,s.PH)("[TASKS] Get dashboard success",(0,s.Ky)()),Y=(0,s.PH)("[TASKS] Get dashboard failure"),O=(0,s.PH)("[TASKS] Change container color",(0,s.Ky)()),B=(0,s.PH)("[TASKS] Change container color failure"),k=(0,s.ZF)("tasks"),j=((0,s.P1)(k,n=>n.isLoading),(0,s.P1)(k,n=>n.backEndErrors)),at=(0,s.P1)(k,n=>n.isTaskCreateModalOpen),ot=(0,s.P1)(k,n=>n.isTaskEditModalOpen),st=(0,s.P1)(k,n=>n.changeTaskFailure),Z=(0,s.P1)(k,n=>n.sortTypeValue),I=(0,s.P1)(k,n=>n.sortByValue),N=(0,s.P1)(k,n=>n.dashboard);var t=c(4650),rt=c(6772);function it(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",8),t.NdJ("click",function(a){t.CHM(e),t.oxw();const r=t.MAs(3);return t.KtG(r.toggle(a))}),t._uU(1," ... "),t.qZA()}}let z=(()=>{class n{constructor(){this.isMenuVisible=!0,this.editEmmiter=new t.vpe,this.deleteEmmiter=new t.vpe,this.archiveEmmiter=new t.vpe}ngOnInit(){this.title=this.subject.name,this.description=this.subject.description,this.createdDate=this.subject.created_at,this.taskId=this.subject._id,this.commentsCount=this.subject.comments.length}dropStart(e){const o=e.target;e.dataTransfer?.setData("text",o.id),o.style.opacity="0.4"}dropEnd(e){e.target.style.opacity="1"}editTask(){this.editEmmiter.emit(this.subject)}deleteTask(){this.deleteEmmiter.emit(this.subject)}archiveTask(){console.log("archive"),this.archiveEmmiter.emit(this.subject)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task"]],inputs:{subject:"subject",isMenuVisible:"isMenuVisible"},outputs:{editEmmiter:"editEmmiter",deleteEmmiter:"deleteEmmiter",archiveEmmiter:"archiveEmmiter"},decls:18,vars:9,consts:[[1,"task",3,"id","draggable","dragstart","dragend"],["class","menu",3,"click",4,"ngIf"],["menu",""],[1,"menu-item",3,"click"],[1,"task__name"],[1,"task__footer"],[1,"task__commentsCount"],[1,"task__creationDate"],[1,"menu",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.NdJ("dragstart",function(r){return o.dropStart(r)})("dragend",function(r){return o.dropEnd(r)}),t.YNc(1,it,2,0,"div",1),t.TgZ(2,"app-element-menu",null,2)(4,"div",3),t.NdJ("click",function(){return o.editTask()}),t._uU(5,"Edit"),t.qZA(),t.TgZ(6,"div",3),t.NdJ("click",function(){return o.deleteTask()}),t._uU(7,"Delete"),t.qZA(),t.TgZ(8,"div",3),t.NdJ("click",function(){return o.archiveTask()}),t._uU(9,"Archive"),t.qZA()(),t.TgZ(10,"div",4),t._uU(11),t.qZA(),t.TgZ(12,"div",5)(13,"div",6),t._uU(14),t.qZA(),t.TgZ(15,"div",7),t._uU(16),t.ALo(17,"date"),t.qZA()()()),2&e&&(t.Q6J("id",o.taskId)("draggable",!0),t.xp6(1),t.Q6J("ngIf",o.isMenuVisible),t.xp6(10),t.Oqu(o.title),t.xp6(3),t.hij("\u2291: ",o.commentsCount,""),t.xp6(2),t.hij(" ",t.xi3(17,6,o.createdDate,"MMM d, h:mm ")," "))},dependencies:[p.O5,rt.T,p.uU],styles:[".task[_ngcontent-%COMP%]{position:relative;display:flex;background-color:#fff;cursor:pointer;padding:10px;flex-direction:column;gap:10px;transition:all .5s;color:green;border-bottom:1px solid gray}.task__name[_ngcontent-%COMP%]{font-size:20px}.task__footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding-top:5px}.task__description[_ngcontent-%COMP%]{font-size:16px;color:gray}.task__creationDate[_ngcontent-%COMP%], .task__commentsCount[_ngcontent-%COMP%]{font-size:18px}.task[_ngcontent-%COMP%]:hover{color:#fff;background-color:green}.menu[_ngcontent-%COMP%]{position:absolute;top:-5px;right:10px;font-size:25px}.menu-item[_ngcontent-%COMP%]{font-size:16px;padding:5px;color:green;transition:all .2s;line-height:14px}.menu-item[_ngcontent-%COMP%]:hover{background-color:#00800057;color:#fff}"],changeDetection:0}),n})(),q=(()=>{class n{transform(e,o){return e.filter(a=>a.status===o)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"taskStatus",type:n,pure:!0}),n})(),R=(()=>{class n{transform(e,o){return e.filter(a=>a.name.toLowerCase().includes(o.toLowerCase()))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"filter",type:n,pure:!0}),n})();function ct(n,i){1&n&&(t.TgZ(0,"div",5),t._uU(1,"Archive is empty"),t.qZA())}function lt(n,i){1&n&&t._UZ(0,"app-task",9),2&n&&t.Q6J("subject",i.$implicit)("isMenuVisible",!1)}function dt(n,i){if(1&n&&(t.ynx(0),t.YNc(1,lt,1,2,"app-task",8),t.ALo(2,"filter"),t.ALo(3,"taskStatus"),t.BQk()),2&n){const e=i.ngIf,o=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,t.xi3(3,4,e.tasks,"ARCHIVED"),o.filterValue))}}function pt(n,i){if(1&n&&(t.TgZ(0,"div",6),t.YNc(1,dt,4,7,"ng-container",7),t.ALo(2,"async"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.dashboard$))}}let _t=(()=>{class n{constructor(e,o){this.store=e,this.router=o,this.isArchiveEmpty=!0,this.filterValue=""}ngOnInit(){this.router.params.pipe((0,_.U)(e=>e.id)).subscribe(e=>{this.dashboardId=e,this.store.dispatch(x({dashboardId:e}))}),this.initValues(),this.dashboard$.subscribe(e=>{this.isArchiveEmpty=0===e?.tasks.filter(o=>"ARCHIVED"===o.status).length})}initValues(){this.backendErrors$=this.store.pipe((0,s.Ys)(j)),this.dashboard$=this.store.pipe((0,s.Ys)(N)),this.sortTypeValue$=this.store.pipe((0,s.Ys)(Z)),this.sortByValue$=this.store.pipe((0,s.Ys)(I))}deleteTask(e){this.store.dispatch(y({taskId:e._id,dashboardId:this.dashboardId}))}setFilterValue(e){this.filterValue=e}sortTypeChange(e){this.store.dispatch(P({value:e}))}sortByChange(e){this.store.dispatch(C({value:e}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.yh),t.Y36(v.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-archive"]],decls:6,vars:2,consts:[[1,"container"],[1,"archive"],[1,"archive__title"],["class","archive__archive-empty",4,"ngIf"],["class","archive__container",4,"ngIf"],[1,"archive__archive-empty"],[1,"archive__container"],[4,"ngIf"],[3,"subject","isMenuVisible",4,"ngFor","ngForOf"],[3,"subject","isMenuVisible"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Archive"),t.qZA(),t.YNc(4,ct,2,0,"div",3),t.YNc(5,pt,3,3,"div",4),t.qZA()()),2&e&&(t.xp6(4),t.Q6J("ngIf",o.isArchiveEmpty),t.xp6(1),t.Q6J("ngIf",!o.isArchiveEmpty))},dependencies:[p.sg,p.O5,z,p.Ov,q,R],styles:[".container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding-top:50px}.archive__title[_ngcontent-%COMP%]{font-size:25px}.archive__archive-empty[_ngcontent-%COMP%]{text-align:center;font-size:22px;color:gray;padding-top:50px}.archive__container[_ngcontent-%COMP%]{padding-top:50px}"],changeDetection:0}),n})();var d=c(433),ut=c(312),gt=c(3963);let mt=(()=>{class n{constructor(e){this.store=e,this.value="#ffffff"}ngOnInit(){}changeColor(e){const o=e.target?.value;this.store.dispatch(O({dashboardId:this.dashboardId,containerType:this.containerType,color:{color:o}}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.yh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-container-color"]],inputs:{value:"value",dashboardId:"dashboardId",containerType:"containerType"},decls:1,vars:1,consts:[["type","color",3,"value","change"]],template:function(e,o){1&e&&(t.TgZ(0,"input",0),t.NdJ("change",function(r){return o.changeColor(r)}),t.qZA()),2&e&&t.Q6J("value",o.value)},styles:["input[_ngcontent-%COMP%]{width:100%;border:none;height:20px}"]}),n})();function ht(n,i){1&n&&(t.TgZ(0,"div",12),t._uU(1," Oops... Something went wrong. "),t.TgZ(2,"span",13),t._uU(3,"Try again"),t.qZA()())}function kt(n,i){1&n&&(t.TgZ(0,"div",12),t._uU(1," Oops... Something went wrong. Please, try again.. "),t.qZA())}function ft(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-task",23),t.NdJ("editEmmiter",function(a){t.CHM(e);const r=t.oxw(4);return t.KtG(r.openTaskEditWindow(a))})("archiveEmmiter",function(a){t.CHM(e);const r=t.oxw(4);return t.KtG(r.archiveTasks(a))})("deleteEmmiter",function(a){t.CHM(e);const r=t.oxw(4);return t.KtG(r.deleteTask(a))}),t.qZA()}if(2&n){const e=i.$implicit;t.Q6J("subject",e)("routerLink","tasks/"+e._id)}}function Tt(n,i){if(1&n&&(t.ynx(0),t.YNc(1,ft,1,2,"app-task",22),t.ALo(2,"filter"),t.ALo(3,"taskStatus"),t.BQk()),2&n){const e=i.ngIf,o=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,t.xi3(3,4,e.tasks,"TODO"),o.filterValue))}}function vt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-task",25),t.NdJ("editEmmiter",function(a){t.CHM(e);const r=t.oxw(4);return t.KtG(r.openTaskEditWindow(a))})("deleteEmmiter",function(a){t.CHM(e);const r=t.oxw(4);return t.KtG(r.deleteTask(a))})("archiveEmmiter",function(a){t.CHM(e);const r=t.oxw(4);return t.KtG(r.archiveTasks(a))}),t.qZA()}if(2&n){const e=i.$implicit;t.Q6J("subject",e)("routerLink","tasks/"+e._id)}}function Ct(n,i){if(1&n&&(t.ynx(0),t.YNc(1,vt,1,2,"app-task",24),t.ALo(2,"filter"),t.ALo(3,"taskStatus"),t.BQk()),2&n){const e=i.ngIf,o=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,t.xi3(3,4,e.tasks,"IN_PROGRESS"),o.filterValue))}}function xt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-task",25),t.NdJ("editEmmiter",function(a){t.CHM(e);const r=t.oxw(4);return t.KtG(r.openTaskEditWindow(a))})("deleteEmmiter",function(a){t.CHM(e);const r=t.oxw(4);return t.KtG(r.deleteTask(a))})("archiveEmmiter",function(a){t.CHM(e);const r=t.oxw(4);return t.KtG(r.archiveTasks(a))}),t.qZA()}if(2&n){const e=i.$implicit;t.Q6J("subject",e)("routerLink","tasks/"+e._id)}}function bt(n,i){if(1&n&&(t.ynx(0),t.YNc(1,xt,1,2,"app-task",24),t.ALo(2,"filter"),t.ALo(3,"taskStatus"),t.BQk()),2&n){const e=i.ngIf,o=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,t.xi3(3,4,e.tasks,"DONE"),o.filterValue))}}const $=function(n){return{"background-color":n}};function yt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"div",16),t._uU(3,"TODO"),t.qZA(),t.TgZ(4,"div",17),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.openTaskCreateWindow("TODO"))}),t._uU(5," + "),t.qZA(),t.TgZ(6,"div",18),t.NdJ("dragover",function(a){t.CHM(e);const r=t.oxw(2);return t.KtG(r.dragOver(a))})("drop",function(a){t.CHM(e);const r=t.oxw(2);return t.KtG(r.dragDrop(a))}),t.ALo(7,"async"),t.YNc(8,Tt,4,7,"ng-container",0),t.ALo(9,"async"),t.qZA(),t._UZ(10,"app-container-color",19),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"div",15)(13,"div",16),t._uU(14,"IN PROGRESS"),t.qZA(),t.TgZ(15,"div",17),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.openTaskCreateWindow("IN_PROGRESS"))}),t._uU(16," + "),t.qZA(),t.TgZ(17,"div",20),t.NdJ("dragover",function(a){t.CHM(e);const r=t.oxw(2);return t.KtG(r.dragOver(a))})("drop",function(a){t.CHM(e);const r=t.oxw(2);return t.KtG(r.dragDrop(a))}),t.ALo(18,"async"),t.YNc(19,Ct,4,7,"ng-container",0),t.ALo(20,"async"),t.qZA(),t._UZ(21,"app-container-color",19),t.ALo(22,"async"),t.qZA(),t.TgZ(23,"div",15)(24,"div",16),t._uU(25,"DONE"),t.qZA(),t.TgZ(26,"div",17),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.openTaskCreateWindow("DONE"))}),t._uU(27," + "),t.qZA(),t.TgZ(28,"div",21),t.NdJ("dragover",function(a){t.CHM(e);const r=t.oxw(2);return t.KtG(r.dragOver(a))})("drop",function(a){t.CHM(e);const r=t.oxw(2);return t.KtG(r.dragDrop(a))}),t.ALo(29,"async"),t.YNc(30,bt,4,7,"ng-container",0),t.ALo(31,"async"),t.qZA(),t._UZ(32,"app-container-color",19),t.ALo(33,"async"),t.qZA()()}if(2&n){const e=t.oxw(2);let o,a,r,m,F,K;t.xp6(6),t.Q6J("ngStyle",t.VKq(33,$,null==(o=t.lcZ(7,15,e.dashboard$))||null==o.colors?null:o.colors.TODO)),t.xp6(2),t.Q6J("ngIf",t.lcZ(9,17,e.dashboard$)),t.xp6(2),t.Q6J("dashboardId",e.dashboardId)("containerType","TODO")("value",null==(a=t.lcZ(11,19,e.dashboard$))||null==a.colors?null:a.colors.TODO),t.xp6(7),t.Q6J("ngStyle",t.VKq(35,$,null==(r=t.lcZ(18,21,e.dashboard$))||null==r.colors?null:r.colors.IN_PROGRESS)),t.xp6(2),t.Q6J("ngIf",t.lcZ(20,23,e.dashboard$)),t.xp6(2),t.Q6J("dashboardId",e.dashboardId)("containerType","IN_PROGRESS")("value",null==(m=t.lcZ(22,25,e.dashboard$))||null==m.colors?null:m.colors.IN_PROGRESS),t.xp6(7),t.Q6J("ngStyle",t.VKq(37,$,null==(F=t.lcZ(29,27,e.dashboard$))||null==F.colors?null:F.colors.DONE)),t.xp6(2),t.Q6J("ngIf",t.lcZ(31,29,e.dashboard$)),t.xp6(2),t.Q6J("dashboardId",e.dashboardId)("containerType","DONE")("value",null==(K=t.lcZ(33,31,e.dashboard$))||null==K.colors?null:K.colors.DONE)}}function Pt(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"div",4)(3,"app-sort",5),t.NdJ("sortTypeChanged",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.sortTypeChange(a))})("sortByChanged",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.sortByChange(a))})("filterChanged",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.setFilterValue(a))}),t.ALo(4,"async"),t.ALo(5,"async"),t.TgZ(6,"option",6),t._uU(7,"Name"),t.qZA(),t.TgZ(8,"option",7),t._uU(9,"Date"),t.qZA()(),t.TgZ(10,"div",8),t._uU(11,"ARCHIVE"),t.qZA(),t.TgZ(12,"div",9),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.deleteDashboard())}),t._uU(13," DELETE DASHBOARD "),t.qZA()(),t.YNc(14,ht,4,0,"div",10),t.ALo(15,"async"),t.YNc(16,kt,2,0,"div",10),t.ALo(17,"async"),t.YNc(18,yt,34,39,"div",11),t.ALo(19,"async"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("sortByValue",t.lcZ(4,6,e.sortByValue$))("sortTypeValue",t.lcZ(5,8,e.sortTypeValue$)),t.xp6(7),t.Q6J("routerLink","archive"),t.xp6(4),t.Q6J("ngIf",t.lcZ(15,10,e.backendErrors$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(17,12,e.changeTaskFailure$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(19,14,e.backendErrors$))}}function At(n,i){1&n&&(t.TgZ(0,"div",26),t._uU(1," Oops... Something went wrong\n"),t.qZA())}function Et(n,i){1&n&&(t.TgZ(0,"p",32),t._uU(1," An error occured. Please, try later "),t.qZA())}function St(n,i){1&n&&(t.TgZ(0,"p",32),t._uU(1," Name should be at least 6 symbols and not more than 24 symbols, description should be not more than 52 symbols "),t.qZA())}function Mt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-modal",27),t.NdJ("modalClose",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.closeTaskCreateModal())})("modalSubmit",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.postTask())}),t.YNc(1,Et,2,0,"p",28),t.ALo(2,"async"),t.YNc(3,St,2,0,"p",28),t.TgZ(4,"form",29),t._UZ(5,"input",30)(6,"textarea",31),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("title","Create task"),t.xp6(1),t.Q6J("ngIf",t.lcZ(2,4,e.changeTaskFailure$)),t.xp6(2),t.Q6J("ngIf",e.isValidationError),t.xp6(1),t.Q6J("formGroup",e.taskForm)}}function Ot(n,i){1&n&&(t.TgZ(0,"p",32),t._uU(1," An error occured. Please, try later "),t.qZA())}function Zt(n,i){1&n&&(t.TgZ(0,"p",32),t._uU(1," Name should be at least 6 symbols and not more than 24 symbols, description should be not more than 52 symbols "),t.qZA())}function It(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-modal",27),t.NdJ("modalClose",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.closeTaskEditModal())})("modalSubmit",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.editTask(a))}),t.YNc(1,Ot,2,0,"p",28),t.ALo(2,"async"),t.YNc(3,Zt,2,0,"p",28),t.TgZ(4,"form",29),t._UZ(5,"input",33)(6,"textarea",34),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("title","Edit task"),t.xp6(1),t.Q6J("ngIf",t.lcZ(2,4,e.changeTaskFailure$)),t.xp6(2),t.Q6J("ngIf",e.isValidationError),t.xp6(1),t.Q6J("formGroup",e.taskForm)}}const Nt=[{path:"",component:(()=>{class n{constructor(e,o){this.store=e,this.router=o,this.isValidationError=!1,this.filterValue=""}ngOnInit(){this.initValues(),this.router.params.pipe((0,_.U)(e=>e.id)).subscribe(e=>{this.dashboardId=e,this.store.dispatch(x({dashboardId:e}))})}archiveTasks(e){this.store.dispatch(b({taskData:{status:"ARCHIVED"},dashboardId:this.dashboardId,taskId:e._id}))}setFilterValue(e){this.filterValue=e}sortTypeChange(e){this.store.dispatch(P({value:e}))}sortByChange(e){this.store.dispatch(C({value:e}))}initValues(){this.isCreateModalVisible$=this.store.pipe((0,s.Ys)(at)),this.isEditModalVisible$=this.store.pipe((0,s.Ys)(ot)),this.changeTaskFailure$=this.store.pipe((0,s.Ys)(st)),this.backendErrors$=this.store.pipe((0,s.Ys)(j)),this.dashboard$=this.store.pipe((0,s.Ys)(N)),this.sortTypeValue$=this.store.pipe((0,s.Ys)(Z)),this.sortByValue$=this.store.pipe((0,s.Ys)(I))}createForm(e=null,o=null,a=!1,r){this.taskForm=new d.cw({name:new d.NI(e,[d.kI.minLength(6),d.kI.maxLength(24),d.kI.required]),description:new d.NI({value:o,disabled:a},d.kI.maxLength(150)),status:new d.NI(r)})}checkError(){return this.taskForm.get("name")?.errors||this.taskForm.get("description")?.errors?(this.isValidationError=!0,!1):(this.isValidationError=!1,!0)}deleteDashboard(){this.store.dispatch(G({dashboardId:this.dashboardId}))}openTaskCreateWindow(e){this.createForm(null,null,!1,e),this.store.dispatch(w())}closeTaskCreateModal(){this.store.dispatch(V())}postTask(){this.checkError()&&(this.store.dispatch(E({data:this.taskForm.value,dashboardId:this.dashboardId})),this.taskForm.reset())}dragDrop(e){const a=e.target.dataset.type,r=e.dataTransfer?.getData("text");this.store.dispatch(b({taskData:{status:a},dashboardId:this.dashboardId,taskId:r}))}dragOver(e){e.preventDefault()}openTaskEditWindow(e){this.taskId=e._id,this.createForm(e.name,e.description,!1),this.store.dispatch(J())}closeTaskEditModal(){this.store.dispatch(L())}editTask(e){this.checkError()&&(this.store.dispatch(S({taskData:this.taskForm.value,dashboardId:this.dashboardId,taskId:this.taskId})),this.taskForm.reset())}deleteTask(e){this.store.dispatch(y({taskId:e._id,dashboardId:this.dashboardId}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.yh),t.Y36(v.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task-page"]],decls:8,vars:12,consts:[[4,"ngIf"],["class","back-end-error",4,"ngIf"],[3,"title","modalClose","modalSubmit",4,"ngIf"],[1,"container"],[1,"control-bar"],[3,"sortByValue","sortTypeValue","sortTypeChanged","sortByChanged","filterChanged"],["value","name"],["value","date"],[1,"archive-link",3,"routerLink"],[1,"delete-button",3,"click"],["class","global-error",4,"ngIf"],["class","content",4,"ngIf"],[1,"global-error"],["href","/"],[1,"content"],[1,"tasks"],[1,"tasks__container-title"],[1,"tasks__add-task",3,"click"],["data-type","TODO",1,"tasks__container",3,"ngStyle","dragover","drop"],[3,"dashboardId","containerType","value"],["data-type","IN_PROGRESS",1,"tasks__container",3,"ngStyle","dragover","drop"],["data-type","DONE",1,"tasks__container",3,"ngStyle","dragover","drop"],[3,"subject","routerLink","editEmmiter","archiveEmmiter","deleteEmmiter",4,"ngFor","ngForOf"],[3,"subject","routerLink","editEmmiter","archiveEmmiter","deleteEmmiter"],[3,"subject","routerLink","editEmmiter","deleteEmmiter","archiveEmmiter",4,"ngFor","ngForOf"],[3,"subject","routerLink","editEmmiter","deleteEmmiter","archiveEmmiter"],[1,"back-end-error"],[3,"title","modalClose","modalSubmit"],["class","modal-error-message",4,"ngIf"],[1,"modal-form",3,"formGroup"],["formControlName","name","type","text","placeholder","task name",1,"form__input"],["formControlName","description","type","text","placeholder","task description","rows","10",1,"form__input"],[1,"modal-error-message"],["formControlName","name","type","text","placeholder","dashboard name",1,"form__input"],["formControlName","description","type","text","placeholder","dashboard description","rows","10",1,"form__input"]],template:function(e,o){1&e&&(t.YNc(0,Pt,20,16,"ng-container",0),t.ALo(1,"async"),t.YNc(2,At,2,0,"div",1),t.ALo(3,"async"),t.YNc(4,Mt,7,6,"app-modal",2),t.ALo(5,"async"),t.YNc(6,It,7,6,"app-modal",2),t.ALo(7,"async")),2&e&&(t.Q6J("ngIf",!t.lcZ(1,4,o.backendErrors$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,6,o.backendErrors$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,8,o.isCreateModalVisible$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,10,o.isEditModalVisible$)))},dependencies:[p.sg,p.O5,p.PC,v.rH,ut.z,d._Y,d.YN,d.Kr,d.Fj,d.JJ,d.JL,d.sg,d.u,gt.x,z,mt,p.Ov,q,R],styles:[".modal-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:10px;gap:20px}.modal-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;border:5px;height:35px;font-size:18px;border:1px solid gray;box-sizing:border-box;color:#444;padding:5px;font-family:serif}.modal-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{font-size:18px;border:1px solid gray;box-sizing:border-box;color:#444;padding:5px;font-family:serif}.modal-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active{border:1px solid rgba(0,0,255,.233)}.modal-error-message[_ngcontent-%COMP%]{font-size:14px;color:red;text-align:center}.archive-link[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s}.archive-link[_ngcontent-%COMP%]:hover{color:#008000b0}.content[_ngcontent-%COMP%]{margin:0 auto;display:flex;padding-top:50px;justify-content:space-between}.tasks[_ngcontent-%COMP%]{flex:0 1 30%}.tasks__add-task[_ngcontent-%COMP%]{color:green;border:1px solid green;border-bottom:none;font-size:24px;box-sizing:border-box;padding:10px;text-align:center;cursor:pointer;transition:.2s ease-in}.tasks__add-task[_ngcontent-%COMP%]:hover{color:#fff;background-color:green}.tasks__container[_ngcontent-%COMP%]{border:1px solid gray;height:100%;background-color:#fff}.tasks__container-title[_ngcontent-%COMP%]{font-size:18px;color:green;padding-bottom:5px}.container[_ngcontent-%COMP%]{max-width:1600px;margin:0 auto;position:relative;background-color:#fff;z-index:20}.back-end-error[_ngcontent-%COMP%]{padding-top:50px;font-size:24px;color:gray;text-align:center}.control-bar[_ngcontent-%COMP%]{display:flex;gap:40px;justify-content:center}.archive-link[_ngcontent-%COMP%]{font-size:22px;color:green;line-height:70px}.delete-button[_ngcontent-%COMP%]{font-size:14px;line-height:70px;color:#3f3f3f;cursor:pointer}.delete-button[_ngcontent-%COMP%]:hover{color:#8080807e}"],changeDetection:0}),n})()},{path:"archive",component:_t}];let $t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[v.Bz.forChild(Nt),v.Bz]}),n})();var l=c(2655),u=c(3900),g=c(9646),f=c(262),Ft=c(8505),T=c(2340);let W=(()=>{class n{constructor(e,o,a){this.http=e,this.store=o,this.router=a,this.store.select(N).subscribe(r=>{this.dashboard=r}),this.store.select(Z).subscribe(r=>{this.sortTypeValue=r}),this.store.select(I).subscribe(r=>{this.sortByValue=r})}postTask(e,o){return this.http.post(`${T.N.apiUrl}dashboards/${o}/tasks`,e)}editTask(e,o,a){return this.http.patch(`${T.N.apiUrl}dashboards/${o}/tasks/${a}`,e)}deleteTask(e,o){return this.http.delete(`${T.N.apiUrl}dashboards/${e}/tasks/${o}`)}changeTaskStatus(e,o,a){return this.http.put(`${T.N.apiUrl}dashboards/${e}/tasks/${o}`,a)}sortTasks(){if(this.dashboard){let e=JSON.parse(JSON.stringify(this.dashboard));switch(this.sortByValue){case"name":e=this.sortByName(e);break;case"date":e=this.sortByDate(e)}return"DESC"===this.sortTypeValue&&(e=this.sortReverse(e)),e}return null}sortByName(e){return e.tasks=e.tasks.sort((o,a)=>o.name>a.name?1:-1),e}sortByDate(e){return e.tasks=e.tasks.sort((o,a)=>Date.parse(a.created_at.toString())-Date.parse(o.created_at.toString())),e}sortReverse(e){return e.tasks=e.tasks.reverse(),e}getDashboard(e){return this.http.get(`${T.N.apiUrl}dashboards/${e}`).pipe((0,_.U)(a=>({name:a.name,description:a.description,created_at:a.created_at,created_by:a.created_by,_id:a._id,tasks:a.tasks,colors:a.colors})))}changeColor(e,o,a){return this.http.put(`${T.N.apiUrl}dashboards/${e}/color/${o}`,a)}deleteDashboard(e){return this.http.delete(`${T.N.apiUrl}dashboards/${e}`)}navigateToMainPage(){this.router.navigate(["/"])}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(A.eN),t.LFG(s.yh),t.LFG(v.F0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),Kt=(()=>{class n{constructor(e,o){this.actions$=e,this.taskService=o,this.updateDashboardEffect$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(h),(0,u.w)(({dashboardId:a})=>(0,g.of)(x({dashboardId:a}))))),this.changeTaskStatusEffect$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(b),(0,u.w)(({taskData:a,dashboardId:r,taskId:m})=>this.taskService.changeTaskStatus(r,m,a).pipe((0,_.U)(()=>h({dashboardId:r})),(0,f.K)(()=>(0,g.of)(H())))))),this.postDashboardsEffect$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(E),(0,u.w)(({data:a,dashboardId:r})=>this.taskService.postTask(a,r).pipe((0,_.U)(()=>h({dashboardId:r})),(0,f.K)(()=>(0,g.of)(X())))))),this.editTasksEffect$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(S),(0,u.w)(({dashboardId:a,taskId:r,taskData:m})=>this.taskService.editTask(m,a,r).pipe((0,_.U)(()=>h({dashboardId:a})),(0,f.K)(()=>(0,g.of)(tt())))))),this.deleteDashboardEffect$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(y),(0,u.w)(({dashboardId:a,taskId:r})=>this.taskService.deleteTask(a,r).pipe((0,_.U)(()=>h({dashboardId:a})),(0,f.K)(()=>(0,g.of)(et())))))),this.sortDashboards$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(M,h,P,C),(0,u.w)(()=>(0,g.of)(Q({dashboard:this.taskService.sortTasks()}))))),this.getDashdboardEffect$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(x),(0,u.w)(({dashboardId:a})=>this.taskService.getDashboard(a).pipe((0,_.U)(r=>M({dashboard:r})),(0,f.K)(()=>(0,g.of)(Y())))))),this.changeColorEffect$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(O),(0,u.w)(({dashboardId:a,containerType:r,color:m})=>this.taskService.changeColor(a,r,m).pipe((0,_.U)(()=>h({dashboardId:a})),(0,f.K)(()=>(0,g.of)(B())))))),this.deleteDashboardFromTaskPageEffect$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(G),(0,u.w)(({dashboardId:a})=>this.taskService.deleteDashboard(a).pipe((0,_.U)(()=>U()),(0,f.K)(()=>(0,g.of)(nt())))))),this.redirectToMainPageEffect$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(U),(0,Ft.b)(()=>{this.taskService.navigateToMainPage()})),{dispatch:!1})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(l.eX),t.LFG(W))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const wt=(0,s.Lq)({backEndErrors:null,isLoading:null,isTaskCreateModalOpen:!1,isTaskEditModalOpen:!1,changeTaskFailure:!1,sortTypeValue:"ASC",sortByValue:"date",dashboard:null},(0,s.on)(w,n=>({...n,isTaskCreateModalOpen:!0})),(0,s.on)(V,n=>({...n,isTaskCreateModalOpen:!1})),(0,s.on)(E,n=>({...n,isLoading:!0,changeTaskFailure:!1})),(0,s.on)(S,n=>({...n,isLoading:!0,changeTaskFailure:!1})),(0,s.on)(h,n=>({...n,isTaskCreateModalOpen:!1,isTaskEditModalOpen:!1,isLoading:!1})),(0,s.on)(J,n=>({...n,isTaskEditModalOpen:!0})),(0,s.on)(L,n=>({...n,isTaskEditModalOpen:!1})),(0,s.on)(y,n=>({...n})),(0,s.on)(b,n=>({...n})),(0,s.on)(H,n=>({...n,changeTaskFailure:!0})),(0,s.on)(P,(n,i)=>({...n,sortTypeValue:i.value})),(0,s.on)(C,(n,i)=>({...n,sortByValue:i.value})),(0,s.on)(C,(n,i)=>({...n,sortByValue:i.value})),(0,s.on)(x,n=>({...n,isLoading:!0,backEndErrors:!1})),(0,s.on)(M,(n,i)=>({...n,isLoading:!1,dashboard:i.dashboard,backEndErrors:!1})),(0,s.on)(Y,n=>({...n,isLoading:!1,backEndErrors:!0,dashboards:null})),(0,s.on)(Q,(n,i)=>({...n,dashboard:i.dashboard})),(0,s.on)(O,n=>({...n,backEndErrors:!1})),(0,s.on)(B,n=>({...n,backEndErrors:!0})));var Jt=c(8566),Vt=c(5811),Lt=c(8332),Ht=c(6933);let Gt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[W,{provide:A.TP,useClass:Jt.I,multi:!0}],imports:[p.ez,$t,A.JF,s.Aw.forFeature("tasks",wt),l.sQ.forFeature([Kt]),Vt.z,d.UX,Lt.U,Ht.t]}),n})()}}]);