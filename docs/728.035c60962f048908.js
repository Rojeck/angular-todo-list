"use strict";(self.webpackChunkTODOListProject=self.webpackChunkTODOListProject||[]).push([[728],{728:(nt,P,r)=>{r.r(P),r.d(P,{TaskViewPageModule:()=>et});var l=r(6895),f=r(3841),g=r(4004),s=r(2997);const _=(0,s.PH)("[TASK] Get task action",(0,s.Ky)()),A=(0,s.PH)("[TASK] Get task success action",(0,s.Ky)()),y=(0,s.PH)("[TASK] Get task failure action"),k=(0,s.PH)("[TASK] Post comment action",(0,s.Ky)()),E=(0,s.PH)("[TASK] Post comment success action",(0,s.Ky)()),w=(0,s.PH)("[TASK] Post comment failure action"),Z=(0,s.PH)("[TASK] Delete comment action",(0,s.Ky)()),O=(0,s.PH)("[TASK] Delete comment success action",(0,s.Ky)()),V=(0,s.PH)("[TASK] Delete comment failure action"),h=(0,s.ZF)("task"),F=(0,s.P1)(h,e=>e.task),S=(0,s.P1)(h,e=>e.commentBackEndErrors),U=(0,s.P1)(h,e=>e.backEndErrors);var t=r(4650);function z(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",1)(1,"div",2),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.deleteComment())}),t._uU(2,"\u2716"),t.qZA(),t.TgZ(3,"div",3),t._uU(4),t.qZA(),t.TgZ(5,"div",4),t._uU(6),t.ALo(7,"date"),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(4),t.hij(" ",n.text," "),t.xp6(2),t.hij(" ",t.xi3(7,2,n.date,"M/d/yy, h:mm a")," ")}}let L=(()=>{class e{constructor(n){this.store=n}ngOnInit(){this.date=this.subject.created_at,this.text=this.subject.text}deleteComment(){this.store.dispatch(Z({dashboardId:this.dashboardId,commentId:this.subject._id,taskId:this.taskId}))}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(s.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-comment"]],inputs:{subject:"subject",dashboardId:"dashboardId",taskId:"taskId"},decls:1,vars:1,consts:[["class","comment",4,"ngIf"],[1,"comment"],[1,"comment__delete-button",3,"click"],[1,"comment__text"],[1,"comment__date"]],template:function(n,o){1&n&&t.YNc(0,z,8,5,"div",0),2&n&&t.Q6J("ngIf",o.subject)},dependencies:[l.O5,l.uU],styles:[".comment[_ngcontent-%COMP%]{width:100%;border:1px solid gray;display:flex;position:relative;flex-direction:column;background-color:#fff;box-sizing:border-box;padding:10px;gap:20px}.comment__delete-button[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;cursor:pointer;font-size:20px;color:#5c5c5c}.comment__text[_ngcontent-%COMP%]{font-size:20px;color:green}.comment__date[_ngcontent-%COMP%]{font-size:18px;color:#5c5c5c;text-align:right}"]}),e})();var m=r(433);function K(e,c){1&e&&(t.TgZ(0,"div",6),t._uU(1,"Oops.. something went wrong"),t.qZA())}function N(e,c){1&e&&(t.TgZ(0,"div",7),t._uU(1,"Oops.. validation error"),t.qZA())}let $=(()=>{class e{constructor(n){this.store=n,this.isValidationError=!1}ngOnInit(){this.backEndError=this.store.select(S),this.createForm()}createForm(){this.commentForm=new m.cw({text:new m.NI(null,[m.kI.minLength(6),m.kI.maxLength(150),m.kI.required])})}checkError(){return this.commentForm.get("text")?.errors?(this.isValidationError=!0,!1):(this.isValidationError=!1,!0)}postComment(){this.checkError()?(this.store.dispatch(k({dashboardId:this.dashboardId,taskId:this.taskId,data:this.commentForm.value})),this.commentForm.reset()):this.isValidationError=!0}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(s.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-comment-add"]],inputs:{taskId:"taskId",dashboardId:"dashboardId"},decls:8,vars:5,consts:[[1,"comment-block"],["class","comment-block__backend-error",4,"ngIf"],["class","comment-block__validation-error",4,"ngIf"],[1,"comment-block__form",3,"formGroup"],["formControlName","text","placeholder","comment text","rows","5",1,"comment-block__input"],[1,"comment-block__button",3,"click"],[1,"comment-block__backend-error"],[1,"comment-block__validation-error"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.YNc(1,K,2,0,"div",1),t.ALo(2,"async"),t.YNc(3,N,2,0,"div",2),t.TgZ(4,"form",3),t._UZ(5,"textarea",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return o.postComment()}),t._uU(7,"Send"),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,3,o.backEndError)),t.xp6(2),t.Q6J("ngIf",o.isValidationError),t.xp6(1),t.Q6J("formGroup",o.commentForm))},dependencies:[l.O5,m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u,l.Ov],styles:[".comment-block[_ngcontent-%COMP%]{padding-top:50px;position:relative;z-index:20}.comment-block__backend-error[_ngcontent-%COMP%]{font-size:16px;color:red}.comment-block__validation-error[_ngcontent-%COMP%]{font-size:16px;color:#c00000}.comment-block__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:25px}.comment-block__input[_ngcontent-%COMP%]{width:100%;font-size:16px;color:gray;box-sizing:border-box;padding:10px;border:1px solid gray}.comment-block__button[_ngcontent-%COMP%]{background-color:green;font-size:18px;box-sizing:border-box;padding:10px;cursor:pointer;align-self:flex-end;width:150px;color:#fff;border:none}"]}),e})();function J(e,c){if(1&e&&(t.TgZ(0,"div",11),t._uU(1),t.ALo(2,"async"),t.qZA()),2&e){const n=t.oxw(2);let o;t.xp6(1),t.hij(" ",null==(o=t.lcZ(2,1,n.task))?null:o.description," ")}}function j(e,c){1&e&&(t.TgZ(0,"div",12),t._uU(1," Description is empty "),t.qZA())}function Y(e,c){if(1&e&&(t.TgZ(0,"div",15),t._UZ(1,"app-comment",16),t.qZA()),2&e){const n=c.$implicit,o=t.oxw(3);t.xp6(1),t.Q6J("subject",n)("taskId",o.taskId)("dashboardId",o.dashboardId)}}function G(e,c){if(1&e&&(t.TgZ(0,"div",13),t.YNc(1,Y,2,3,"div",14),t.ALo(2,"async"),t.qZA()),2&e){const n=t.oxw(2);let o;t.xp6(1),t.Q6J("ngForOf",null==(o=t.lcZ(2,1,n.task))?null:o.comments)}}function Q(e,c){1&e&&(t.TgZ(0,"div",17),t._uU(1,"comments is empty"),t.qZA())}function B(e,c){if(1&e&&(t.ynx(0),t.TgZ(1,"div",2)(2,"div",3)(3,"div",4),t._uU(4),t.ALo(5,"async"),t.qZA(),t.TgZ(6,"div",5),t._uU(7),t.ALo(8,"date"),t.ALo(9,"async"),t.qZA(),t.YNc(10,J,3,3,"div",6),t.ALo(11,"async"),t.YNc(12,j,2,0,"ng-template",null,7,t.W1O),t.qZA(),t._UZ(14,"app-comment-add",8),t.YNc(15,G,3,3,"div",9),t.ALo(16,"async"),t.YNc(17,Q,2,0,"ng-template",null,10,t.W1O),t.qZA(),t.BQk()),2&e){const n=t.MAs(13),o=t.MAs(18),a=t.oxw();let i,d,u,I;t.xp6(4),t.Oqu(null==(i=t.lcZ(5,8,a.task))?null:i.name),t.xp6(3),t.hij(" ",t.xi3(8,10,null==(d=t.lcZ(9,13,a.task))?null:d.created_at,"M/d/yy, h:mm a")," "),t.xp6(3),t.Q6J("ngIf",null==(u=t.lcZ(11,15,a.task))?null:u.description)("ngIfElse",n),t.xp6(4),t.Q6J("taskId",a.taskId)("dashboardId",a.dashboardId),t.xp6(1),t.Q6J("ngIf",null==(I=t.lcZ(16,17,a.task))||null==I.comments?null:I.comments.length)("ngIfElse",o)}}function H(e,c){1&e&&(t.TgZ(0,"div",18),t._uU(1,"Oops... Something went wrong"),t.qZA())}const D=[{path:"",component:(()=>{class e{constructor(n,o){this.store=n,this.router=o}ngOnInit(){this.getTask(),this.initValues()}getTask(){this.router.params.pipe((0,g.U)(n=>({taskId:n.taskId,dashboardId:n.id}))).subscribe(n=>{this.dashboardId=n.dashboardId,this.taskId=n.taskId,this.store.dispatch(_({dashboardId:n.dashboardId,taskId:n.taskId}))})}initValues(){this.task=this.store.select(F),this.backEndErrors$=this.store.select(U)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(s.yh),t.Y36(f.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-task-view-page"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["backEndError",""],[1,"container"],[1,"task"],[1,"task__name"],[1,"task__date"],["class","task__description",4,"ngIf","ngIfElse"],["NoDescription",""],[3,"taskId","dashboardId"],["class","comments__container",4,"ngIf","ngIfElse"],["noComments",""],[1,"task__description"],[1,"task__description-none"],[1,"comments__container"],["class","comment",4,"ngFor","ngForOf"],[1,"comment"],[3,"subject","taskId","dashboardId"],[1,"comments__no-comments"],[1,"back-end-error"]],template:function(n,o){if(1&n&&(t.YNc(0,B,19,19,"ng-container",0),t.ALo(1,"async"),t.YNc(2,H,2,0,"ng-template",null,1,t.W1O)),2&n){const a=t.MAs(3);t.Q6J("ngIf",!t.lcZ(1,2,o.backEndErrors$))("ngIfElse",a)}},dependencies:[l.sg,l.O5,L,$,l.Ov,l.uU],styles:[".task[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;padding-top:50px}.task__name[_ngcontent-%COMP%]{font-size:32px;color:green}.task__date[_ngcontent-%COMP%]{text-align:right;font-size:20px}.task__description[_ngcontent-%COMP%]{font-size:22px;color:#464646}.task__description-none[_ngcontent-%COMP%]{font-size:22px;color:gray}.container[_ngcontent-%COMP%]{max-width:1300px;margin:0 auto}.comments__container[_ngcontent-%COMP%]{padding-top:30px;position:relative;z-index:20;display:flex;flex-direction:column;gap:4px;width:100%}.comments__no-comments[_ngcontent-%COMP%]{text-align:center;font-size:20px;color:gray}.back-end-error[_ngcontent-%COMP%]{font-size:24px;color:gray;padding-top:100px;text-align:center}"],changeDetection:0}),e})()}];let W=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[f.Bz.forChild(D),f.Bz]}),e})();var x=r(2340),C=r(529);let M=(()=>{class e{constructor(n){this.http=n}getTask(n,o){return this.http.get(`${x.N.apiUrl}dashboards/${n}`).pipe((0,g.U)(i=>{const d=i.tasks.find(u=>u._id===o);if(!d)throw new Error("Task does not exist");return d}))}postComment(n,o,a){return this.http.post(`${x.N.apiUrl}dashboards/${n}/tasks/${o}/comments`,a)}deleteComment(n,o,a){return this.http.delete(`${x.N.apiUrl}dashboards/${n}/tasks/${o}/comments/${a}`)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(C.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();const X=(0,s.Lq)({backEndErrors:!1,commentBackEndErrors:null,isLoading:null,task:null},(0,s.on)(_,e=>({...e,isLoading:!0,backEndErrors:!1})),(0,s.on)(A,(e,c)=>({...e,isLoading:!1,task:c.task})),(0,s.on)(y,e=>({...e,isLoading:!1,backEndErrors:!0})),(0,s.on)(w,e=>({...e,commentBackEndErrors:!0})),(0,s.on)(k,e=>({...e,commentBackEndErrors:!1})));var p=r(2655),T=r(3900),v=r(262),b=r(9646);let R=(()=>{class e{constructor(n,o){this.actions$=n,this.taskService=o,this.getTaskEffect$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(_,E,O),(0,T.w)(({dashboardId:a,taskId:i})=>this.taskService.getTask(a,i).pipe((0,g.U)(d=>A({task:d})),(0,v.K)(()=>(0,b.of)(y())))))),this.postCommentAction$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(k),(0,T.w)(({dashboardId:a,taskId:i,data:d})=>this.taskService.postComment(a,i,d).pipe((0,g.U)(()=>E({dashboardId:a,taskId:i})),(0,v.K)(()=>(0,b.of)(w())))))),this.deleteCommentAction$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(Z),(0,T.w)(({dashboardId:a,taskId:i,commentId:d})=>this.taskService.deleteComment(a,i,d).pipe((0,g.U)(()=>O({dashboardId:a,taskId:i})),(0,v.K)(()=>(0,b.of)(V()))))))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(p.eX),t.LFG(M))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();var tt=r(8566);let et=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[M,{provide:C.TP,useClass:tt.I,multi:!0}],imports:[l.ez,W,C.JF,m.UX,s.Aw.forFeature("task",X),p.sQ.forFeature([R])]}),e})()}}]);